# pro.guap-report-generator
Программа gener_report.py написана так, что её можно использовать, как встроенный модуль с помощью import. Для этого следует вызвать функцию pr(d). 
import gener_report
gener_report.pr(d)
И передать ей словарь данных. На выход программа передает поток байт. Так же программу можно запустить на машине через командную строку. Для этого при вызове программы следует передать словать с флагами.
python gener_report.py --org "{\"founder\":\"МИНИСТЕРСТВО НАУКИ И ВЫСШЕГО ОБРАЗОВАНИЯ РОССИЙСКОЙ ФЕДЕРАЦИИ\", \"name\":\"федеральное государственное автономное образовательное учреждение высшего образования «САНКТ-ПЕТЕРБУРГСКИЙ ГОСУДАРСТВЕННЫЙ УНИВЕРСИТЕТ АЭРОКОСМИЧЕСКОГО ПРИБОРОСТРОЕНИЯ»\" , \"faculty\":\"ИНСТИТУТ НЕПРЕРЫВНОГО И ДИСТАНЦИОННОГО ОБРАЗОВАНИЯ\", \"department\":\"КАФЕДРА информационных технологий и программной инженерии\"}" --stu "{\"name\":\"Иван\", \"surname\":\"Иванов\", \"patronymic\":\"Иванович\", \"group\":\"4931\", \"identity_card\":\"2019/9876\"}" --rep "{\"subject_name\":\"Операционные системы\", \"task_name\":\"ЛР1. Знакомство с командным интерпретатором bash\", \"task_type\":\"Лабораторная работа\"}" --tea "{\"name\":\"Юлия\", \"surname\":\"Антохина\", \"patronymic\": \"Анатольевна\", \"status\":\"Ректор, д.т.н.\"}" --struc "[\"Цель\", \"Задание\", \"Результат выполнения\", \"Выводы\"]"
Нужные данные вставляются в словать по опреденному ключу и передаются в функцию, которая генерирует титульный лист. Далее main() по байтно записывает полученные данные в docx файл. И на жестком диске машины создается верно заполненный титульный лист

Тесты написаны путем построчного и поячеичного сравнения эталонного файла. Для этого написана программа erroscach.py.  doc.paragraphs выгрузка всех строк отчета. Так как отчет состоит не только из строк, но и из таблиц следует произвести выгрузку таблиц: doc.tables. Далее в программе написаны сравнения с определенными местами титульного листа, то есть те которые обязательны (ФИ, статус, группа, кафедра). 
Этот файл вызывает pytest. Для тестов, так же создан отдельно эталонный словарь в inputd.py. 
